Comments={_auth:void 0,_sync:void 0,_timestamp:void 0,init:function(e,n){if("firebase"==e)firebase.initializeApp(n),Comments._auth=firebase.auth(),Comments._sync=firebase.database(),Comments._timestamp=firebase.database.ServerValue.TIMESTAMP;else if("wilddog"==e){var t=wilddog.initializeApp(n);Comments._auth=t.auth(),Comments._sync=t.sync(),Comments._timestamp=t.sync().ServerValue.TIMESTAMP}},handleError:function(e){console.log(e)},errors:{ALREADY_LOGED_IN:"已经处于登录状态。",NOT_LOGIN:"没有登录。",DISPLAYNAME_CAN_NOT_BLANK:"昵称不能为空",DISPLAYNAME_TOO_LONG:"昵称太长了",POSTID_CAN_NOT_BLANK:"文章ID不能为空"},handleCallback:function(e,n){e&&e(n)},user:{get:function(){return Comments._auth.currentUser},register:function(e,n,t){var m=Comments.user.get();m?(Comments.handleError(Comments.errors.ALREADY_LOGED_IN),Comments.handleCallback(t,void 0)):Comments._auth.createUserWithEmailAndPassword(e,n).then(function(e){Comments.handleCallback(t,e)})["catch"](function(e){Comments.handleError(e),Comments.handleCallback(t,void 0)})},login:function(e,n,t){var m=Comments.user.get();m?(Comments.handleError(Comments.errors.ALREADY_LOGED_IN),Comments.handleCallback(t,void 0)):Comments._auth.signInWithEmailAndPassword(e,n).then(function(e){Comments.handleCallback(t,e)})["catch"](function(e){Comments.handleError(e),Comments.handleCallback(t,void 0)})},logout:function(){var e=Comments.user.get();e?Comments._auth.signOut()["catch"](function(e){findghost.handleError(e)}):Comments.handleError(Comments.errors.NOT_LOGIN)},displayName:{get:function(e){if(!e)var e=Comments.user.get();if(e){var n=e.displayName;return n?n:e.email.split("@")[0]}},set:function(e,n){if(e.length<=0)return Comments.handleError(Comments.errors.DISPLAYNAME_CAN_NOT_BLANK),void Comments.handleCallback(n,void 0);if(e.length>10)return void Comments.handleError(Comments.errors.DISPLAYNAME_TOO_LONG);var t=Comments.user.get();if(t){{Comments.user.displayName.get()}Comments._auth.currentUser.updateProfile({displayName:e}).then(function(e){Comments.handleCallback(n,e)})["catch"](function(e){Comments.handleCallback(n,void 0),Comments.handleError(e)})}}},updateCallback:function(e){Comments._auth.onAuthStateChanged(e)}},comment:{list:function(e,n){e?Comments._sync.ref("/comments").orderByChild("pid").equalTo(e).once("value",function(e){Comments.handleCallback(n,e.val())}):(Comments.handleError(Comments.errors.POSTID_CAN_NOT_BLANK),Comments.handleCallback(n,void 0))},listCallback:function(e,n){if(e){var t=Comments._sync.ref("/comments").orderByChild("pid").equalTo(e);return t.on("value",function(e){n(e.val())}),t}Comments.handleError(Comments.errors.POSTID_CAN_NOT_BLANK),Comments.handleCallback(n,void 0)},add:function(e,n,t,m,o){var a=Comments.user.get();if(a){var s=Comments._sync.ref("/comments");s.push({date:Comments._timestamp,uid:a.uid,uname:Comments.user.displayName.get(),uurl:m,pid:e,msg:n,pcid:t})["catch"](function(e){Comments.handleError(e),Comments.handleCallback(o,void 0)}),Comments.handleCallback(o,!0)}else Comments.handleCallback(o,void 0),Comments.handleError(Comments.errors.NOT_LOGIN)},recent:{_callback:void 0,get:function(e,n){e||(e=10),Comments._sync.ref("/comments").orderByChild("date").limitToLast(e).once("value",function(e){Comments.handleCallback(n,e.val())})},updateCallback:function(e,n){Comments.comment.recent.removeCallback(),Comments.comment._callback=Comments._sync.ref("/comments").orderByChild("date").limitToLast(e),Comments.comment._callback.on("value",function(e){n(e.val())})},removeCallback:function(){Comments.comment._callback&&(Comments.comment._callback.remove(),Comments.comment._callback=void 0)}}}};