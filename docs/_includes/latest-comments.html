<script src="https://www.gstatic.com/firebasejs/3.7.3/firebase.js"></script>
<!-- <script src="https://cdn.wilddog.com/sdk/js/2.5.2/wilddog.js"></script> -->
<script src="{{ site.baseurl }}/js/comments.js"></script>

<h1 class="page-heading">Latest 7 comments</h1>
<div id="comments"></div>
<script type="text/javascript">
  //Wilddog
/*  var config = {
    authDomain: "blogcomments.wilddog.com",
    syncURL: "https://blogcomments.wilddogio.com"
  };
  Comments.init("wilddog", config);*/
  
  //firebase

  var config = {
    apiKey: "AIzaSyDE3Xjq8H8_sMLu-VQ8-D86pH67B3QsBpI",
    authDomain: "blog-comments-fa868.firebaseapp.com",
    databaseURL: "https://blog-comments-fa868.firebaseio.com",
    storageBucket: "blog-comments-fa868.appspot.com",
    messagingSenderId: "463015654208"
  };
  Comments.init("firebase", config);


Comments.comment.recent.updateCallback(7, function(messages) {
    var div = document.getElementById("comments");
    div.innerHTML = "";
    for (commentId in messages) {
      var comment = messages[commentId];
      var div_comment = document.createElement("div");
      var div_name = document.createElement("strong");
      div_name.innerHTML = htmlEscape(comment.name);
      div_name.title = new Date(parseInt(comment.timestamp)).toDateString();
      div_comment.appendChild(div_name);

      var postId = comment.post;
      var div_message = document.createElement("a");
      div_message.href = "{{ site.baseurl }}" + postId;
      div_message.innerHTML = " " + htmlEscape(comment.comment).slice(0, 20);
      div_message.title = htmlEscape(comment.comment);
      
      /*var quote_button = document.createElement("button");
      quote_button.innerHTML = "Reply";
      quote_button.id = commentId;
      div_comment.appendChild(quote_button);*/
      div_comment.appendChild(div_message);


      div.appendChild(div_comment);
      div.insertBefore(div_comment, div.firstChild);
    }
  });

  function htmlEscape(str) {
    return str
        .replace(/&/g, '&amp;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
  }
</script>